yeast_grouped2 <-
yeast |>
group_by(Pool, Cyr1.geno)
# as before, use glimpse to take a look at this df
is.grouped_df(yeast_grouped)
groups(yeast_grouped)
groups(yeast_grouped2)
group_keys(yeast_grouped)
group_keys(yeast_grouped2)
group_size(yeast_grouped)
group_size(yeast_grouped2)
yeast_ungrouped <- ungroup(yeast_grouped)
is.grouped_df(yeast_ungrouped)
count(yeast_grouped2)
yeast |>
count(Pool, Cyr1.geno)
yeast_grouped2 |>
summarize(nobs = n(),
mean_Cyr1.exp = mean(Cyr1.expr, na.rm = TRUE),
sd_Cyr1.exp = sd(Cyr1.expr, na.rm = TRUE))
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(starts_with("Adhes"))),
mean.CM = mean(c_across(CM.a:CM.c)))
# two different ways to select columns above
# Note that ranges can be fragile when data gets reordered
penguins |>
mutate(deviation = body_mass_g - mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation) |> # pull is similar to $
head(5)
penguins |>
group_by(species) |>
mutate(deviation = body_mass_g - mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation) |> # pull is similar to $
head(5)
#| output: true
penguins |>
filter(!is.na(sex)) |>
ggplot(aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point(alpha = 0.5) +
geom_smooth(method = lm, alpha=0.5)
penguins_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex)
lm_by_species_sex <-
penguins_by_species_sex |>
group_map(~lm(flipper_length_mm ~ body_mass_g, data = .x))
lm_by_species_sex
library(broom)
lm_by_species_sex_df <-
penguins_by_species_sex |>
group_modify(~ broom::tidy(lm(flipper_length_mm ~ body_mass_g, data = .x)))
lm_by_species_sex_df
clean_penguins <-
penguins |>
filter(!is.na(sex))
penguins_grand <-
clean_penguins |>
summarize(mean_bodymass = mean(body_mass_g))
penguins_group <-
clean_penguins |>
group_by(species) |>
summarize(mean_bodymass = mean(body_mass_g))
jitterpos <- position_jitter(width=0.25, height=0,
seed = 20240917)
clean_penguins |>
ggplot(aes(x = species, y = body_mass_g,
color = species)) +
geom_point(position = jitterpos, alpha=0.5) +
geom_hline(yintercept = penguins_grand$mean_bodymass,
linetype='dashed')
clean_penguins |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_hline(yintercept = grand_mean_bodymass, linetype='dashed')
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5)
penguins_group
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point()
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 2) +
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 2)
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 3)
clean_penguins |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 3) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 3) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = mean_bodymass),
alpha=0.5) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 3) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = mean_bodymass),
alpha=0.75, width=2) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 3) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = mean_bodymass),
alpha=0.75, size=2) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_hline(data = penguins_group,
yintercept = grand_mean_bodymass, linetype='dashed')
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_point(data = penguins_group)
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_point(data = penguins_group,
aes(x = species, y = mean_bodymass))
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_point(data = penguins_group,
aes(x = species, y = mean_bodymass),
size = 3, alpha = 0.5)
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_point(data = penguins_group,
aes(x = species, y = mean_bodymass),
size = 3)
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.35,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.35) +
geom_point(data = penguins_group,
aes(x = species, y = mean_bodymass),
size = 3)
library(patchwork)
combined <- p_overall + p_between + p_within
p_overall <-
clean_penguins |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
p_overall
library(patchwork)
combined <- p_overall + p_between + p_within
#| echo: true
#| output: false
library(tidyverse)
library(palmerpenguins)
set.seed(20240916)
data_URL <- "https://tinyurl.com/36h67mhm"
yeast <- read_csv(data_URL)
glimpse(yeast)  # a prettier version of str
# View(yeast)   # look at the data frame in the RStudio viewer
#| eval: true
#| output: true
yeast_grouped <-
yeast |>
group_by(Pool)
# use glimpse or str to view the grouped df
yeast_grouped2 <-
yeast |>
group_by(Pool, Cyr1.geno)
# as before, use glimpse to take a look at this df
is.grouped_df(yeast_grouped)
groups(yeast_grouped)
groups(yeast_grouped2)
group_keys(yeast_grouped)
group_keys(yeast_grouped2)
group_size(yeast_grouped)
group_size(yeast_grouped2)
yeast_ungrouped <- ungroup(yeast_grouped)
is.grouped_df(yeast_ungrouped)
count(yeast_grouped2)
yeast |>
count(Pool, Cyr1.geno)
yeast_grouped2 |>
summarize(nobs = n(),
mean_Cyr1.exp = mean(Cyr1.expr, na.rm = TRUE),
sd_Cyr1.exp = sd(Cyr1.expr, na.rm = TRUE))
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(starts_with("Adhes"))),
mean.CM = mean(c_across(CM.a:CM.c)))
# two different ways to select columns above
# Note that ranges can be fragile when data gets reordered
penguins |>
mutate(deviation = body_mass_g - mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation) |> # pull is similar to $
head(5)
penguins |>
group_by(species) |>
mutate(deviation = body_mass_g - mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation) |> # pull is similar to $
head(5)
#| output: true
penguins |>
filter(!is.na(sex)) |>
ggplot(aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point(alpha = 0.5) +
geom_smooth(method = lm, alpha=0.5)
penguins_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex)
lm_by_species_sex <-
penguins_by_species_sex |>
group_map(~lm(flipper_length_mm ~ body_mass_g, data = .x))
lm_by_species_sex
library(broom)
lm_by_species_sex_df <-
penguins_by_species_sex |>
group_modify(~ broom::tidy(lm(flipper_length_mm ~ body_mass_g, data = .x)))
lm_by_species_sex_df
clean_penguins <-
penguins |>
filter(!is.na(sex))
penguins_grand <-
clean_penguins |>
summarize(mean_bodymass = mean(body_mass_g))
penguins_group <-
clean_penguins |>
group_by(species) |>
summarize(mean_bodymass = mean(body_mass_g))
jitterpos <- position_jitter(width=0.25, height=0,
seed = 20240917)
clean_penguins |>
ggplot(aes(x = species, y = body_mass_g,
color = species)) +
geom_point(position = jitterpos, alpha=0.5) +
geom_hline(yintercept = penguins_grand$mean_bodymass,
linetype='dashed')
p_overall <-
clean_penguins |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
p_overall
p_between <-
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 3) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = mean_bodymass),
alpha=0.75, size=2) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed')
p_between
p_within <-
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.35,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.35) +
geom_point(data = penguins_group,
aes(x = species, y = mean_bodymass),
size = 3)
p_within
library(patchwork)
combined <- p_overall + p_between + p_within
combined
#| fig-width: 10
#| fig-height: 6
library(patchwork)
combined <- p_overall + p_between + p_within
combined
#| fig-width: 10
#| fig-height: 6
library(patchwork)
combined <- (p_overall + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_withing + theme(legend.position = "none"))
#| fig-width: 10
#| fig-height: 6
library(patchwork)
combined <- (p_overall + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_within + theme(legend.position = "none"))
combined
library(patchwork)
combined <- (p_overall + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_within + theme(legend.position = "none"))
combined
p_total <-
clean_penguins |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.5,
size=0.5) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.5) +
geom_hline(yintercept = penguins_grand$mean_bodymass, linetype='dashed') +
ylim(2500,6500)
p_total
p_between <-
penguins_group |>
ggplot(aes(x = species,
y = mean_bodymass,
color = species)) +
geom_point(size = 3) +
geom_linerange(aes(ymin = penguins_grand$mean_bodymass,
ymax = mean_bodymass),
alpha=0.75, size=2) +
geom_hline(yintercept = penguins_grand$mean_bodymass,
linetype='dashed') +
ylim(2500,6500)
p_between
p_within <-
clean_penguins |>
group_by(species) |>
mutate(group_mean_bodymass = mean(body_mass_g, na.rm = TRUE)) |>
ggplot(aes(x = species,
y = body_mass_g,
color = species)) +
geom_point(position = jitterpos,
alpha=0.35,
size=0.5) +
geom_linerange(aes(ymin = group_mean_bodymass,
ymax = body_mass_g),
position = jitterpos,
alpha=0.35) +
geom_point(data = penguins_group,
aes(x = species, y = mean_bodymass),
size = 3) +
ylim(2500,6500)
p_within
library(patchwork)
combined <- (p_overall + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_within + theme(legend.position = "none"))
combined
library(patchwork)
combined <- (p_total + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_within + theme(legend.position = "none"))
combined
library(patchwork)
combined <- (p_total + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_within + theme(legend.position = "none")) +
plot_layout(heights = 0.5)
combined
library(patchwork)
combined <- (p_total + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_within + theme(legend.position = "none")) +
plot_layout(heights = 0.5,
widths = 1)
combined
#| fig-width: 12
#| fig-height: 4
library(patchwork)
combined <- (p_total + theme(legend.position = "none")) +
(p_between + theme(legend.position = "none")) +
(p_within + theme(legend.position = "none"))
combined
