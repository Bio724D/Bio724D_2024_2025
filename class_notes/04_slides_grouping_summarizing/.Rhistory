lm_by_group <-
yeast_grouped |>
group_map(~lm(Adhes.a ~ Flo11.expr, data = .x))
lm_by_group
summary(lm_by_group)
lm_by_group <-
yeast_grouped |>
group_map(~lm(Adhes.a ~ Flo11.expr, data = .x))
lm_by_group
summary(lm_by_group)
lm_by_group <-
yeast_grouped |>
group_map(~lm(Adhes.a ~ Flo11.expr, data = .x))
lm_by_group
summary(lm_by_group)
summary(lm_by_group[[1]])
names(lm_by_group[[1]])
enframe(lm_by_group[[1]])
enframe(as.list(lm_by_group[[1]]))
lm_by_group[[1]]
lm_by_group[[1]]$coefficients
engrame(lm_by_group[[1]]$coefficients)
enframe(lm_by_group[[1]]$coefficients)
as.tibble(lm_by_group[[1]]$coefficients)
library(broom)
lm_by_group2 <-
yeast_grouped |>
group_modify(~lm(Adhes.a ~ Flo11.expr, data = .x)))
library(broom)
lm_by_group2 <-
yeast_grouped |>
group_modify(~broom::tidy(lm(Adhes.a ~ Flo11.expr, data = .x)))
lm_by_group2
library(broom)
lm_by_group2 <-
yeast_grouped |>
group_modify(~broom::glance(lm(Adhes.a ~ Flo11.expr, data = .x)))
lm_by_group2
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)))
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
ggplot(aes(x = mean.CM, y = mean.Adhes)) +
geom_point()
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
ggplot(aes(x = Flo11.expr, y = mean.Adhes)) +
geom_point()
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
ggplot(aes(x = Flo11.expr, y = mean.CM)) +
geom_point()
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
ggplot(aes(x = Flo11.expr, y = mean.Adhes)) +
geom_point()
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
ggplot(aes(x = Log2(Flo11.expr), y = Log2(mean.Adhes))) +
geom_point()
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
ggplot(aes(x = log2(Flo11.expr), y = log2(mean.Adhes))) +
geom_point()
lm_by_group <-
yeast_grouped |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)))
group_map(~lm(mean.Adhes ~ Flo11.expr, data = .x))
lm_by_group <-
yeast_grouped |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
group_map(~lm(mean.Adhes ~ Flo11.expr, data = .x))
lm_by_group <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c))) |>
group_by(Cyr1.geno) |>
group_map(~lm(mean.Adhes ~ Flo11.expr, data = .x))
lm_by_group
lm_by_group <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
group_by(Cyr1.geno) |>
group_map(~lm(log2.Adhes ~ log2.Flo11, data = .x))
lm_by_group
lm_by_group <-
yeast_grouped_Cyr1 <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
group_by(Cyr1.geno)
ggplot(yeast_grouped_Cyr1, aex(x = log2.Flo11, y = log2.Adhes)) +
geom_point()
lm_by_group <-
yeast_grouped_Cyr1 <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
group_by(Cyr1.geno)
ggplot(yeast_grouped_Cyr1, aes(x = log2.Flo11, y = log2.Adhes)) +
geom_point()
lm_by_Cyr1 <-
yeast_grouped_Cyr1 |>
group_map(~lm(log2.Adhes ~ log2.Flo11, data = .x))
lm_by_Cyr1
lm_by_group <-
yeast_grouped_Cyr1 <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
group_by(Cyr1.geno)
ggplot(yeast_grouped_Cyr1, aes(x = log2.Flo11,
y = log2.Adhes,
color = Cyr1.geno)) +
geom_point()
lm_by_Cyr1 <-
yeast_grouped_Cyr1 |>
group_map(~lm(log2.Adhes ~ log2.Flo11, data = .x))
lm_by_Cyr1
lm_by_group <-
yeast_grouped_Cyr1 <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
filter(Cyr1.geno!== "H") |>
lm_by_group <-
yeast_grouped_Cyr1 <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
filter(Cyr1.geno != "H") |>
group_by(Cyr1.geno)
ggplot(yeast_grouped_Cyr1, aes(x = log2.Flo11,
y = log2.Adhes,
color = Cyr1.geno)) +
geom_point()
lm_by_Cyr1 <-
yeast_grouped_Cyr1 |>
group_map(~lm(log2.Adhes ~ log2.Flo11, data = .x))
lm_by_Cyr1
lm_by_group <-
yeast_grouped_Cyr1 <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
filter(Cyr1.geno != "H") |>
group_by(Cyr1.geno)
ggplot(yeast_grouped_Cyr1, aes(x = log2.Flo11,
y = log2.Adhes,
color = Cyr1.geno)) +
geom_point() +
geom_smooth(stat="lm")
lm_by_group <-
yeast_grouped_Cyr1 <-
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)),
log2.Adhes = log2(mean.Adhes),
log2.Flo11 = log2(Flo11.expr)) |>
filter(Cyr1.geno != "H") |>
group_by(Cyr1.geno)
ggplot(yeast_grouped_Cyr1, aes(x = log2.Flo11,
y = log2.Adhes,
color = Cyr1.geno)) +
geom_point() +
geom_smooth(method = lm)
lm_by_Cyr1 <-
yeast_grouped_Cyr1 |>
group_map(~lm(log2.Adhes ~ log2.Flo11, data = .x))
lm_by_Cyr1
lm_by_Cyr1 <-
yeast_grouped_Cyr1 |>
group_map(~lm(log2.Adhes ~ log2.Flo11, data = .x))
lm_by_Cyr1
lm_by_Cyr1[[1]]
lm_by_Cyr1[[1]]$coefficients
lm_by_Cyr1[[1]]$coefficients
names(lm_by_Cyr1[[1]])
library(broom)
lm_by_Cyr1_df <-
yeast_grouped_Cyr1 |>
group_modify(~ broom::tidy(lm(log2.Adhes ~ log2.Flo11, data = .x)))
lm_by_group2
library(broom)
lm_by_Cyr1_df <-
yeast_grouped_Cyr1 |>
group_modify(~ broom::glance(lm(log2.Adhes ~ log2.Flo11, data = .x)))
lm_by_group2
library(broom)
lm_by_Cyr1_df <-
yeast_grouped_Cyr1 |>
group_modify(~ broom::glance(lm(log2.Adhes ~ log2.Flo11, data = .x)))
lm_by_Cyr1_df
library(broom)
lm_by_Cyr1_df <-
yeast_grouped_Cyr1 |>
group_modify(~ broom::tidy(lm(log2.Adhes ~ log2.Flo11, data = .x)))
lm_by_Cyr1_df
library(broom)
lm_by_Cyr1_df <-
yeast_grouped_Cyr1 |>
group_modify(~ broom::glimpse(lm(log2.Adhes ~ log2.Flo11, data = .x)))
library(broom)
lm_by_Cyr1_df <-
yeast_grouped_Cyr1 |>
group_modify(~ broom::glance(lm(log2.Adhes ~ log2.Flo11, data = .x)))
lm_by_Cyr1_df
names(lm_by_Cyr1[[1]])
penguins
library(palmerpenguins)
View(penguins)
penguins |> count(species, island, sex)
levels(penguins$island)
glimpse(penguins)
penguins |> count(island, species, sex)
penguins_raw
View(penguins_raw)
births <- read_tsv("https://github.com/Bio723-class/example-datasets/raw/master/nc-births.txt")
View(births)
penguins[[2]]
penguins[2]
possums <- read_csv("https://tinyurl.com/lindenmayer-possums")
View(possums)
len(penguins)
length(penguins)
nrow(penguins)
seq(1, nrow(penguins), by=5)
rows <- seq(1, nrow(penguins), by=5)
penguins[rows,]
penguins |>
group_by(species) |>
slice_sample(n=5)
#| eval: true
#| output: true
penguins_by_species <-
penguins |>
group_by(penguins)
#| echo: true
#| output: false
library(tidyverse)
library(palmerpenguins)
set.seed(20240916)  # set seed for random number generation
#| eval: true
#| output: true
penguins_by_species <-
penguins |>
group_by(penguins)
#| eval: true
#| output: true
penguins_by_species <-
penguins |>
group_by(species)
# use glimpse or str to view the grouped df
by_species_sex <-
penguins |>
group_by(species, sex)
# as before, use glimpse to take a look at this df
#| echo: true
#| output: false
library(tidyverse)
library(palmerpenguins)
set.seed(20240916)  # set seed for random number generation
#| eval: true
#| output: true
by_species <-
penguins |>
group_by(species)
# use glimpse or str to view the grouped df
by_species_sex <-
penguins |>
group_by(species, sex)
# as before, use glimpse to take a look at this df
is.grouped_df(by_species)
groups(by_species)
groups(by_species_sex)
group_keys(by_species)
group_keys(by_species_sex)
group_size(by_species)
group_size(by_species_sex)
penguins_ungrouped <- ungroup(by_sex)
penguins_ungrouped <- ungroup(by_species)
is.grouped_df(yeast_ungrouped)
penguins_ungrouped <- ungroup(by_species)
is.grouped_df(penguins_ungrouped)
count(by_species_sex)
penguins |>
count(species, sex)
by_species_sex |>
summarize(nobs = n(),
mean_bodymass = mean(body_mass_g, na.rm = TRUE),
sd_bodymass = sd(body_mass_g, na.rm = TRUE))
#| echo: true
#| output: false
library(tidyverse)
library(palmerpenguins)
set.seed(20240916)
data_URL <- "https://tinyurl.com/36h67mhm"
yeast <- read_csv(data_URL)
glimpse(yeast)  # a prettier version of str
# View(yeast)   # look at the data frame in the RStudio viewer
#| eval: true
#| output: true
yeast_grouped <-
yeast |>
group_by(Pool)
# use glimpse or str to view the grouped df
yeast_grouped2 <-
yeast |>
group_by(Pool, Cyr1.geno)
# as before, use glimpse to take a look at this df
is.grouped_df(yeast_grouped)
groups(yeast_grouped)
groups(yeast_grouped2)
group_keys(yeast_grouped)
group_keys(yeast_grouped2)
group_keys(yeast_grouped)
group_keys(yeast_grouped2)
group_size(yeast_grouped)
group_size(yeast_grouped2)
yeast_ungrouped <- ungroup(yeast_grouped)
is.grouped_df(yeast_ungrouped)
count(yeast_grouped2)
yeast |>
count(Pool, Cyr1.geno)
yeast_grouped2 |>
summarize(nobs = n(),
mean_Cyr1.exp = mean(Cyr1.expr, na.rm = TRUE),
sd_Cyr1.exp = sd(Cyr1.expr, na.rm = TRUE))
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)))
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(Adhes.a:Adhes.c)),
mean.CM = mean(c_across(CM.a:CM.c)))
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(starts_with("Adhes"))),
mean.CM = mean(c_across(CM.a:CM.c)))
yeast |>
rowwise() |>
mutate(mean.Adhes = mean(c_across(starts_with("Adhes"))),
mean.CM = mean(c_across(CM.a:CM.c)), .keep="none")
penguins |>
mutate(deviation = mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation)  # pull is similar to $
penguins |>
mutate(deviation = body_mass_g - mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation)  # pull is similar to $
penguins |>
mutate(deviation = body_mass_g - mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation) |> # pull is similar to $
head(5)
penguins |>
group_by(species) |>
mutate(deviation = mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation) |> # pull is similar to $
head(5)
penguins |>
group_by(species) |>
mutate(deviation = body_mass_g - mean(body_mass_g, na.rm = TRUE)) |>
pull(deviation) |> # pull is similar to $
head(5)
ggplot(penguins, aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point() +
geom_smooth(method = lm)
penguins |>
filter(!is.na(sex)) |>
ggplot(aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point() +
geom_smooth(method = lm)
penguins |>
filter(!is.na(sex)) |>
ggplot(aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point(alpha = 0.5) +
geom_smooth(method = lm)
penguins |>
filter(!is.na(sex)) |>
ggplot(aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point(alpha = 0.75) +
geom_smooth(method = lm, alpha=0.75)
penguins |>
filter(!is.na(sex)) |>
ggplot(aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point(alpha = 0.5) +
geom_smooth(method = lm, alpha=0.5)
penguins |>
filter(!is.na(sex)) |>
ggplot(aes(x = body_mass_g,
y = flipper_length_mm,
color = species,
shape = sex)) +
geom_point(alpha = 0.5) +
geom_smooth(method = lm, alpha=0.5)
lm_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex)
group_map(~lm(flipper_length_mm ~ body_mass, data = .x))
lm_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex) |>
group_map(~lm(flipper_length_mm ~ body_mass, data = .x))
lm_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex) |>
group_map(~lm(flipper_length_mm ~ body_mass_g, data = .x))
lm_by_species_sex
lm_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex) |>
group_map(~lm(flipper_length_mm ~ body_mass_g, data = .x))
names(lm_by_species_sex)
lm_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex) |>
group_map(~lm(flipper_length_mm ~ body_mass_g, data = .x))
lm_by_species_sex
penguins_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex)
lm_by_species_sex <-
penguins_by_species_sex
group_map(~lm(flipper_length_mm ~ body_mass_g, data = .x))
penguins_by_species_sex <-
penguins |>
filter(!is.na(sex)) |>
group_by(species, sex)
lm_by_species_sex <-
penguins_by_species_sex |>
group_map(~lm(flipper_length_mm ~ body_mass_g, data = .x))
lm_by_species_sex
groups(lm_by_species_sex)
groups(penguins_by_species_sex)
group_keys(penguins_by_species_sex)
library(broom)
lm_by_species_sex_df <-
penguins_by_species_sex |>
group_modify(~ broom::glance(~lm(flipper_length_mm ~ body_mass_g, data = .x)))
library(broom)
lm_by_species_sex_df <-
penguins_by_species_sex |>
group_modify(~ broom::glance(lm(flipper_length_mm ~ body_mass_g, data = .x)))
lm_by_species_sex_df
library(broom)
lm_by_species_sex_df <-
penguins_by_species_sex |>
group_modify(~ broom::tidy(lm(flipper_length_mm ~ body_mass_g, data = .x)))
lm_by_species_sex_df
