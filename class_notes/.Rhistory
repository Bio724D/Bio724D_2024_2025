select(ID, !where(all.na))
clb_cln <-
spellman |>
select(ID, matches("cln3|clb2"))
head(clb_cln)
clb_cln <-
spellman |>
select(ID, matches("cln3|clb2"))
clb_cln
new_penguins <-
penguins |>
mutate(body_mass_kg = body_mass_g/1000)
new_penguins <-
penguins |>
mutate(body_mass_kg = body_mass_g/1000)
new_penguins
new_penguins <-
penguins |>
mutate(body_mass_kg = body_mass_g/1000,
.after = body_mass_g)
new_penguins
new_penguins <-
penguins |>
mutate(body_mass_kg = body_mass_g/1000,
.after = body_mass_g)
new_penguins
new_penguins <-
penguins |>
mutate(body_mass_kg = body_mass_g/1000,
.after = island)
new_penguins
penguins |>
filter(species == "Gentoo")
penguins |>
filter(species != "Gentoo")
penguins |>
filter(species != "Gentoo") |>
str
penguins |>
filter(species != "Gentoo") |>
str()
penguins |>
filter(species != "Gentoo")
penguins |>
filter(species != "Gentoo")
unique(penguins$species)
no_gentoo <-
penguins |>
filter(species != "Gentoo")
unique(no_gentoo$species)
penguins <- read_csv("~/Bio724/penguins.csv")
View(penguins)
new_penguins <-
penguins |>
mutate(body_mass_kg = body_mass_g/1000)
new_penguins
new_penguins <-
penguins |>
mutate(body_mass_kg = body_mass_g/1000) |>
select(species, island, starts_with("body_mass"))
new_penguins
penguins |>
filter(species == "Gentoo")
no_gentoo <-
penguins |>
filter(species != "Gentoo")
unique(no_gentoo$species)
only_gentoo <-
penguins |>
filter(species == "Gentoo")
unique(only_gentoo$species)
no_gentoo <-
penguins |>
filter(species != "Gentoo")
unique(no_gentoo$species)
View(only_gentoo)
penguins |>
filter(species %in% c("Gentoo","Adelie"))
penguins |>
filter(species == "Gentoo", species == "Adelie" )
penguins |>
filter(species == "Gentoo" | species == "Adelie" )
ggplot(penguins, aes(x=body_mass_g)) + geom_histogram()
big_gentoo <-
penguins |>
filter(species == "Gentoo", body_mass_g > 4500)
View(big_gentoo)
penguins |>
filter(is.na(body_mass_g))
penguins |>
filter(!is.na(body_mass_g))
penguins |>
filter(!is.na(body_mass_g)) |>
str()
penguins |>
filter(!is.na(body_mass_g)) |>
dim()
penguins |>
filter(complete.cases)
penguins |>
filter_if(complete.cases)
penguins |>
drop_na(body_mass_g)
penguins |>
drop_na()
penguins |>
drop_na() |>
dim()
penguins |>
drop_na(body_mass_g) |>
dim()
penguins[c("body_mass_g", "species")]
penguins[1, 1]
penguins[1, 1]  # row 1, col 1
penguins[1:5, 1:3]  # rows 1 to 5, columns 1 to 3
penguins[1:4]
View(penguins)
penguins[c("species", "body_mass_g", "sex")]
penguins[c("species", "island", "body_mass_g", "sex")]
penguins[c("body_mass_g")]
penguins$body_mass_g
spellman_alpha <- read_tsv("~/Bio724/spellman-1998-expression.tsv",
col_select = 1:5)  # load first 5 columns
View(spellman_alpha)
spellman_subset <- read_tsv("~/Bio724/spellman-1998-expression.tsv",
col_select = 1:6)  # load first 6 columns
View(spellman_alpha)
View(spellman_subset)
tecan <- read_tsv("~/Bio724/cryptococcus_tecan_run.txt")
# fix the error by specifying the correct encoding
# also tell read_tsv there are no col_names
tecan <- read_tsv("~/Bio724/cryptococcus_tecan_run.txt",
locale = locale(encoding = "windows-1252"),
col_names = FALSE)
# fix the error by specifying the correct encoding
# also tell read_tsv there are no col_names
tecan <- read_tsv("~/Bio724/cryptococcus_tecan_run.txt",
locale = locale(encoding = "windows-1252"),
col_names = FALSE)
View(tecan)
problems(tecan)
View(tecan)
penguins
locale
locale()
locale(fr)
locale("fr")
locale("gr")
locale("es")
locale("de")
penguins$body_mass_g |>
head(30)
penguins$body_mass_g |>
head(50)
penguins[c("body_mass_g")] |>
head(50)
library(readr)
cryptococcus_tecan_run <- read_delim("~/Bio724/cryptococcus_tecan_run.txt",
delim = "\t", escape_double = FALSE,
col_names = FALSE, locale = locale(encoding = "WINDOWS-1252"),
trim_ws = TRUE)
View(cryptococcus_tecan_run)
remove.packages("Rcpp")
remove.packages("Rcpp")
# sort penguins by body_mass_g from biggest to smallest
penguins |>
arrange(body_mass_g)
# sort penguins by bill_length_mm from biggest to smallest
penguins |>
arrange(bill_length_mm)
# sort penguins by bill_length_mm from biggest to smallest
penguins |>
arrange(desc(bill_length_mm))
desc(1:10)
# sort penguins by flipper_length and then by bill_length
penguins |>
arrange(desc(flipper_length_mm), desc(bill_length_mm))
# sort penguins by flipper_length and then by bill_length
penguins |>
arrange(desc(flipper_length_mm), bill_length_mm)
births <- read_tsv("https://github.com/Bio723-class/example-datasets/raw/master/nc-births.txt")
births |> arrange(weight)
View(births)
library(tidyverse)
library(ape)
library(phytools)
library(ggtree)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ggtree")
library(tidyverse)
library(ape)
library(phytools)
library(ggtree)
library(treeio)
library(ggtreeExtra)
BiocManager::install("ggtreeExtra")
library(tidyverse)
library(ape)
library(phytools)
library(ggtree)
library(treeio)
library(ggtreeExtra)
desjardins <- read.tree("CryptoDiversity_Desjardins_Tree.tre")
samples <- read_csv("CryptoDiversity_Sample_Strain_Lineage_HandEdited.csv")
# Desjardins rooted their tree with the VNIIs as outgroup, we'll do the same
VNII_root <- getMRCA(desjardins, c("C2","C12"))
edge_length <- subset(desjardins$edge.length, desjardins$edge[,2] == VNII_root)
desjardins <- reroot(desjardins, VNII_root, edge_length/2)
atree <- full_join(desjardins, samples, by = "label")
ggtree(atree,color='gray',alpha=0.5) +
geom_text(aes(label=node),size=2) +
geom_tiplab(aes(color=Lineage),size=1,) +
scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99", "#CC9933"))
VNBI_node <- getMRCA(desjardins, c("Tu229-1","Ftc267-2"))
VNBII_node <- getMRCA(desjardins, c("MW-RSA3321","Bt34"))
VNIa_node <- getMRCA(desjardins, c("AD4-63a","Tu259-1"))
VNIb_node <- getMRCA(desjardins, c("H99","MW-RSA722"))
VNIc_node <- getMRCA(desjardins, c("Bt79","PMHc1040.ENR.STOR"))
VNII_node <- getMRCA(desjardins, c("C2","C12"))
ggtree(atree, color="gray") +
geom_tiplab(aes(color=Lineage),
size=1, fontface=2, show.legend = FALSE) +
scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99", "#CC9933")) +
geom_cladelab(VNBI_node, label="VNBI",
offset = 0.03, offset.text = 0,
align=TRUE,
fontsize=2, barcolor="#CC6666",textcolor = "#CC6666") +
geom_cladelab(VNBII_node, label="VNBII",
#offset = 0.01, offset.text = 0,
offset = 0.03, offset.text = 0,
align=TRUE,
fontsize=2, barcolor="#9999CC",textcolor = "#9999CC") +
geom_cladelab(VNIa_node, label="VNIa",
#offset = 0.0325, offset.text = 0,
offset = 0.03, offset.text = 0,
align = TRUE,
fontsize=2, barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIb_node, label="VNIb",
#offset = 0.0175, offset.text = 0,
offset = 0.03, offset.text = 0,
align = TRUE,
fontsize=2, barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIc_node, label="VNIc",
#offset = 0.01, offset.text = 0,
offset = 0.03, offset.text = 0,
align = TRUE,
fontsize=2, barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNII_node, label="VNII",
#offset = 0.0175, offset.text = 0,
offset = 0.03, offset.text = 0,
align = TRUE,
fontsize=2, barcolor="#CC9933",textcolor = "#CC9933")
ggsave("desj_tree_lineages_labels.pdf", width = 12, height = 15)
fntsize = 4
p_circ <-
ggtree(atree, color="gray", layout="circular") +
geom_tiplab2(aes(color=Lineage),
align=TRUE, linesize = 0.1,
size=1, fontface=2, show.legend = FALSE) +
scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99", "#CC9933")) +
geom_cladelabel(VNBI_node, label="VNBI",
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
fontsize=fntsize, color="#CC6666") +
#fontsize=2, barcolor="#CC6666",textcolor = "#CC6666") +
geom_cladelab(VNBII_node, label="VNBII",
#offset = 0.01, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align=TRUE,
fontsize=fntsize, barcolor="#9999CC",textcolor = "#9999CC") +
geom_cladelab(VNIa_node, label="VNIa",
#offset = 0.0325, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize, barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIb_node, label="VNIb",
#offset = 0.0175, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize, barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIc_node, label="VNIc",
#offset = 0.01, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize, barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNII_node, label="VNII",
#offset = 0.0175, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize, barcolor="#CC9933",textcolor = "#CC9933")
p_circ
ggsave("desj_tree_lineages_labels_circular.pdf", width = 12, height = 12)
fntsize = 8
fntface = 2 # bold
p_circ <-
ggtree(atree, color="gray", layout="circular") +
geom_tiplab2(aes(color=Lineage),
align=TRUE, linesize = 0.1,
size=1, fontface=2, show.legend = FALSE) +
scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99", "#CC9933")) +
geom_cladelabel(VNBI_node, label="VNBI",
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
fontsize=fntsize, fontface=fntface, color="#CC6666") +
#fontsize=2, barcolor="#CC6666",textcolor = "#CC6666") +
geom_cladelab(VNBII_node, label="VNBII",
#offset = 0.01, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align=TRUE,
fontsize=fntsize,
fontface=fntface, barcolor="#9999CC",textcolor = "#9999CC") +
geom_cladelab(VNIa_node, label="VNIa",
#offset = 0.0325, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIb_node, label="VNIb",
#offset = 0.0175, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIc_node, label="VNIc",
#offset = 0.01, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNII_node, label="VNII",
#offset = 0.0175, offset.text = 0,
offset = 0.035, offset.text = 0.005,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#CC9933",textcolor = "#CC9933")
p_circ
ggsave("desj_tree_lineages_labels_circular.pdf", width = 12, height = 12)
laboffset = 0.008
fntsize = 6
fntface = 2 # bold
p_circ <-
ggtree(atree, color="gray", layout="circular") +
geom_tiplab2(aes(color=Lineage),
align=TRUE, linesize = 0.1,
size=1, fontface=2, show.legend = FALSE) +
scale_color_manual(values=c("#CC6666", "#9999CC", "#66CC99", "#CC9933")) +
geom_cladelabel(VNBI_node, label="VNBI",
offset = 0.035, offset.text = laboffset,
angle = "auto", horizontal=FALSE,
fontsize=fntsize, fontface=fntface, color="#CC6666") +
#fontsize=2, barcolor="#CC6666",textcolor = "#CC6666") +
geom_cladelab(VNBII_node, label="VNBII",
#offset = 0.01, offset.text = 0,
offset = 0.035, offset.text = laboffset,
angle = "auto", horizontal=FALSE,
align=TRUE,
fontsize=fntsize,
fontface=fntface, barcolor="#9999CC",textcolor = "#9999CC") +
geom_cladelab(VNIa_node, label="VNIa",
#offset = 0.0325, offset.text = 0,
offset = 0.035, offset.text = laboffset,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIb_node, label="VNIb",
#offset = 0.0175, offset.text = 0,
offset = 0.035, offset.text = laboffset,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNIc_node, label="VNIc",
#offset = 0.01, offset.text = 0,
offset = 0.035, offset.text = laboffset,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#66CC99",textcolor = "#66CC99") +
geom_cladelab(VNII_node, label="VNII",
#offset = 0.0175, offset.text = 0,
offset = 0.035, offset.text = laboffset,
angle = "auto", horizontal=FALSE,
align = TRUE,
fontsize=fntsize,
fontface=fntface,
barcolor="#CC9933",textcolor = "#CC9933")
p_circ
ggsave("desj_tree_lineages_labels_circular.pdf", width = 12, height = 12)
#| output: false
library(tidyverse)
penguins <- read_csv("~/Bio724/penguins.csv")
# read spellman TSV data
spellman <- read_tsv("~/Bio724/spellman-1998-expression.tsv")
# examine dimension, names, etc
dim(spellman)
names(spellman)
# read first six columns of data file
spellman_6 <- read_tsv("~/Bio724/spellman-1998-expression.tsv",
col_select = 1:6)
# read first six columns of data file
spellman_alpha<- read_tsv("~/Bio724/spellman-1998-expression.tsv",
col_select = c(1, starts_with("alpha")))
head(spellman_alpha)
#| output: false
# this will generate an error
tecan <- read_tsv("~/Bio724/cryptococcus_tecan_run.txt")
# fix the error by specifying the correct encoding using the local argument
# also tell read_tsv there are no col_names
tecan <- read_tsv("~/Bio724/cryptococcus_tecan_run.txt",
locale = locale(encoding = "windows-1252"),
col_names = FALSE)
problems(tecan)
# use read_excel to extract the low expression table
# from Nagalakshmi Supp Table 2
library(readxl)
low <- read_excel("~/Bio724/Nagalakshmi_et_al_2008_TableS2.xls",
sheet = "Low",
range = "A5:G235")
# get only species and "bill" columns from penguin data
penguins |>
select(species, bill_length_mm, bill_depth_mm) |>
head()
# get everything except "bill" columns from penguins
penguins |>
select(species, !bill_length_mm, !bill_depth_mm) |>
head()
# get numeric columns from penguin data
penguins |>
select(where(is.numeric)) |>
head()
# get all the "length" columns from penguins
penguins |>
select(matches("length")) |>
head()
# create a derived column, body_mass_kg, in penguins
penguins |>
mutate(body_mass_kg = body_mass_g / 1000) |>
head()
# get only the rows representing Gentoo penguins
penguins |>
filter(species == "Gentoo")
# exclude the rows that are Gentoo penguins
penguins |>
filter(species != "Gentoo")
# get the Gentoo penguins bigger than 4.5 kg
penguins |>
filter(species == "Gentoo", body_mass_g > 4500)
# get both Gentoo and Adelie penguins using the OR operator
penguins |>
filter(species == "Gentoo" | species == "Adelie" )
# Get Gentoo and Adelie penguins using the %in% operator
penguins |>
filter(species %in% c("Gentoo","Adelie") )
# find rows where body_mass_g has NA values
penguins |>
filter(where(is.na(body_mass_g)))
# find rows where body_mass_g has NA values
penguins |>
filter(is.na(body_mass_g))
# get all rows where body_mass data is NOT missing
penguins |>
filter(!is.na(body_mass_g))
# drop any rows where body_mass_g is missing using drop_na
penguins |>
drop_na(body_mass_g)
# drop rows where any variable has an NA value
penguins |>
drop_na()
# sort penguins by bill_length_mm
penguins |>
arrange(bill_length_mm)
# sort penguins by bill_length_mm from biggest to smallest
penguins |>
arrange(desc(bill_length_mm))
# sort penguins by flipper_length and  bill_length
penguins |>
arrange(flipper_length_mm, bill_length_mm)
penguins[1, 1]  # row 1, col 1
penguins[1:5, 1:3]  # rows 1 to 5, columns 1 to 3
penguins[1:4]
penguins[c("species", "island", "body_mass_g", "sex")]
penguins$body_mass_g |>
head(50)
penguins[c("body_mass_g")] |>
head(50)
install.packages("ggdist")
install.packages("ggtext")
install.packages("patchwork")
library(ggplot2)
library(ggdist) # nice distributional plots
library(ggtext) # useful for text formatting
library(patchwork) # laying out sub-figures
library(palmerpenguins)  # easy access to the penguins data
